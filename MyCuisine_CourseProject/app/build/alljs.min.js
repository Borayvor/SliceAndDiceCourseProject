$(function () {
    'use strict';

    function config($routeProvider) {

        var PARTIALS_PREFIX = 'app/views/partials/';
        var CONTROLLER_AS_VIEW_MODEL = 'vm';

        $routeProvider
            .when('/', {
                templateUrl: PARTIALS_PREFIX + 'home/home.html',
                controller: 'HomeController',
                controllerAs: CONTROLLER_AS_VIEW_MODEL
            })
            .when('/Location', {
                templateUrl: PARTIALS_PREFIX + 'location/location.html',
                controller: 'LocationController',
                controllerAs: CONTROLLER_AS_VIEW_MODEL
            })
            .when('/Menu', {
                templateUrl: PARTIALS_PREFIX + 'menu/menu.html',
                controller: 'MenuController',
                controllerAs: CONTROLLER_AS_VIEW_MODEL
            })
            .otherwise({ redirectTo: '/' });

    }

    function run($http, $cookies, $rootScope, $location) {

        Parse.initialize(
           "XB25RbwIJJMPcISUFMd8yho2qwX3Kpt9useEL0eP",
           "7MDaeNRThiXJi8nm7yWIR32FPorDbj9wUkBFtEev");

        $rootScope.$on('$routeChangeError', function (ev, current, previous, rejection) {
            if (rejection === 'not authorized') {
                $location.path('/');
            }

        });
    }

    angular.module('MyCuisine.services', []);
    angular.module('MyCuisine.directives', []);
    angular.module('MyCuisine.filters', []);

    angular.module('MyCuisine.controllers', ['MyCuisine.services']);
    angular.module('MyCuisine', ['ngRoute', 'ngCookies', 'ui.bootstrap', 'MyCuisine.controllers', 'MyCuisine.directives', 'MyCuisine.filters'])
        .config(['$routeProvider', config])
        .run(['$http', '$cookies', '$rootScope', '$location', run])
        .constant('baseServiceUrl', 'https://api.parse.com/1/');
}());(function () {
    'use strict';

    function menuService(data) {

        var Url = 'classes/Menu?include=category';
        
        function getAll() {            

            return data.get(Url);
        }

        function getRecommended() {

            var urlRecommended = Url + '&where={"recommendation":true}';

            return data.get(urlRecommended);
        }

        return {
            getAll: getAll,
            getRecommended: getRecommended
        };
    }

    angular.module('MyCuisine.services')
        .factory('menuService', ['data', menuService]);
}());(function () {
    'use strict';

    function menuController(menuService, menuCategoryService) {
        var vm = this;
                
        vm.menuItems = {};
        vm.menuCategory = {};

        menuService.getAll()
            .then(function (result) {                
                vm.menuItems = result.results;                
            });

        menuCategoryService.getAll()
            .then(function (result) {
                vm.menuCategory = result.results;
            });
    }

    angular.module('MyCuisine.controllers')
        .controller('MenuController', ['menuService', 'menuCategoryService', menuController]);
}());(function () {
    'use strict';

    function menuCategoryService(data) {

        var Url = 'classes/Category';

        function getAll() {

            return data.get(Url);
        }


        return {
            getAll: getAll
        };
    }

    angular.module('MyCuisine.services')
        .factory('menuCategoryService', ['data', menuCategoryService]);
}());(function () {
    'use strict';
       
    function homeController(carouselService, menuService, locationService) {
        var vm = this;
                
        vm.carouselItems = {};
        vm.menuItems = {};

        carouselService.getAll()
            .then(function (result) {
                vm.carouselItems = result.results;
            });        

        menuService.getRecommended()
            .then(function (result) {
                vm.menuItems = result.results;
            });

        locationService.getMap();

    }

    angular.module('MyCuisine.controllers')
        .controller('HomeController', ['carouselService', 'menuService', 'locationService', homeController]);
}());(function () {
    'use strict';

    function carouselService(data) {

        var URL = 'classes/HeaderItem';

        function getAll() {
            return data.get(URL);
        }
                
        return {
            getAll: getAll
        };
    }

    angular.module('MyCuisine.services')
        .factory('carouselService', ['data', carouselService]);
}());(function () {
    'use strict';

    function locationService(data) {

        //var URL = 'classes/HeaderItem';

        function getMap() {
            var map,
            center,
            marker,
            mapOptions,
            markerOptions;

            center = new google.maps.LatLng(42.650698, 23.379031);

            mapOptions = {
                zoom: 15,
                center: center,

            };

            map = new google.maps.Map(document.getElementById('map'), mapOptions);

            markerOptions = {
                map: map,
                position: center
            };

            marker = new google.maps.Marker(markerOptions);

            window.setTimeout(function () {
                google.maps.event.trigger(map, 'resize');
            }, 100);
        }

        return {
            getMap: getMap
        };
    }

    angular.module('MyCuisine.services')
        .factory('locationService', ['data', locationService]);
}());(function () {
    'use strict';

    function locationController(locationService) {
        var vm = this;

        locationService.getMap();

    }

    angular.module('MyCuisine.controllers')
        .controller('LocationController', ['locationService', locationController]);
}());(function () {
    'use strict';

    function navDirective() {

        var clickedLink = function clickedLink($scope, $element, $attrs) {

            $element.on('click', 'a', function () {
                var name;

                if ($(this).attr("id") === 'logo') {
                    name = $('#myCuisine-navbar-collapse').children("ul").children().first().attr('name');
                } else {
                    name = $(this).parent().attr('name');
                }

                $('#myCuisine-navbar-collapse li[name=' + name + ']').parent().children('.active').removeClass('active');
                $('#myCuisine-footer nav li[name=' + name + ']').parent().children('.active').removeClass('active');

                $('#myCuisine-navbar-collapse li[name=' + name + ']').addClass('active');
                $('#myCuisine-footer nav li[name=' + name + ']').addClass('active');
            });
        };

        return {
            restrict: 'A',
            controller: clickedLink
        };
    }

    angular.module('MyCuisine.directives')
        .directive('navDirective', [navDirective]);
}());(function () {
    'use strict';
        
    function mainController() {
        var vm = this;

//         waitForLogin();
// 
//         vm.logout = function () {
//             vm.globallySetCurrentUser = undefined;
//             auth.logout();
//             waitForLogin();
//             $location.path('/');
//         };
// 
//         function waitForLogin() {
//             identity.getUser()
//                 .then(function (user) {
//                     vm.globallySetCurrentUser = user;
//                 });
//         }
    }

    angular.module('MyCuisine.controllers')
        .controller('MainController', [mainController]);
}());(function () {
    'use strict';    

    function dataService($http, $q, baseUrl) {

        function get(url, params) {
            var defered = $q.defer();

            $http
                .get(baseUrl + url, { 
                    params: params,
                    headers: {                        
                        'X-Parse-Application-Id': 'XB25RbwIJJMPcISUFMd8yho2qwX3Kpt9useEL0eP',
                        'X-Parse-REST-API-Key': 'q4rQJ2UDIPwxbXw0QWPdKz7VBj1RFz0pGiedBgib'
                    }
                })
                .then(function (response) {                    
                    defered.resolve(response.data);
                }, function (err) {
                    
                    defered.reject(err);
                });

            return defered.promise;
        }

        function post(url, data) {
            var defered = $q.defer();

            $http
                .post(baseUrl + url, data)
                .then(function (response) {
                    defered.resolve(response.data);
                }, function (err) {
                    
                    defered.reject(err);
                });

            return defered.promise;
        }

        function put(url, data) {
            var defered = $q.defer();

            $http
                .put(baseUrl + url, data)
                .then(function (response) {
                    defered.resolve(response.data);
                }, function (err) {
                    defered.reject(err);
                });

            return defered.promise;
        }

        return {
            get: get,
            post: post,
            put: put
        };
    }

    angular.module('MyCuisine.services')
        .factory('data', ['$http', '$q', 'baseServiceUrl', dataService]);
}());angular.module("templates").run(["$templateCache", function($templateCache) {$templateCache.put("views/partials/home/home.html","<div class=\"contentMain-header\">\r\n    <div id=\"myCuisineCarousel\" class=\"carousel slide\" data-ride=\"carousel\">\r\n        <!-- Indicators -->\r\n        <ol id=\"carousel-indicators\" class=\"carousel-indicators\">\r\n            <li data-target=\"#myCuisineCarousel\" ng-repeat=\"carouselItem in vm.carouselItems\" ng-class=\"{active: (carouselItem.position === 0)}\" data-slide-to=\"{{carouselItem.position}}\"></li>\r\n        </ol>\r\n\r\n        <!-- Wrapper for slides -->\r\n        <div class=\"carousel-inner\">\r\n            <div ng-class=\"{item: true, active : (carouselItem.position === 0)}\" ng-repeat=\"carouselItem in vm.carouselItems\">\r\n                <img ng-src=\"{{carouselItem.image.url}}\" alt=\"{{carouselItem.title}}\">\r\n                <div class=\"container\">\r\n                    <div class=\"carousel-caption\">\r\n                        <h1 class=\"header-title\">{{carouselItem.title}}</h1>\r\n                        <p class=\"header-body\">\r\n                            {{carouselItem.description}}\r\n                        </p>\r\n                        <a href=\"#/\" class=\"btn browse-content-btn\">Button’s Text Goes Right Here</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Controls -->\r\n        <a class=\"left carousel-control\" href=\"#myCuisineCarousel\" role=\"button\" data-slide=\"prev\">\r\n            <span class=\"glyphicon glyphicon-chevron-left\"></span>\r\n        </a>\r\n        <a class=\"right carousel-control\" href=\"#myCuisineCarousel\" role=\"button\" data-slide=\"next\">\r\n            <span class=\"glyphicon glyphicon-chevron-right\"></span>\r\n        </a>\r\n    </div><!-- end carousel -->\r\n</div>\r\n<!-- ==================================================== -->\r\n\r\n<div id=\"contentMain-content-area\">\r\n    <div id=\"slogan\">\r\n        <div class=\"container\">\r\n            <h2 class=\"slogan-header\">“Your awesome company slogan goes here, we have the best food around”</h2>\r\n            <h5 class=\"slogan-body\">Unc elementum lacus in gravida pellentesque urna dolor eleifend felis eleifend</h5>\r\n            <div id=\"stars\">\r\n                <span class=\"glyphicon glyphicon-star-empty\"></span>\r\n                <span class=\"glyphicon glyphicon-star-empty\"></span>\r\n                <span class=\"glyphicon glyphicon-star-empty\"></span>\r\n                <span class=\"glyphicon glyphicon-star-empty\"></span>\r\n                <span class=\"glyphicon glyphicon-star-empty\"></span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- sssssss -->\r\n\r\n    <div id=\"content-area-container\" class=\"container\">\r\n        <div class=\"content-items row\">\r\n\r\n            <div id=\"recommendations\" class=\"col-xs-12 col-sm-6 col-md-4\">\r\n                <h3 class=\"title\">Chef\'s Recommendations</h3>\r\n                <div class=\"recommendation row\" ng-show=\"menuItem.recommendation\" ng-repeat=\"menuItem in vm.menuItems\">\r\n                    <div class=\"thumb col-xs-12 col-sm-4\">\r\n                        <a href=\"#/{{menuItem.category.name}}/{{menuItem.title}}\">\r\n                            <img ng-src=\"{{menuItem.image.url}}\" class=\"img-thumbnail\" alt=\"{{menuItem.title}}\">\r\n                        </a>\r\n                    </div>\r\n                    <div class=\"recommendation-body col-xs-12 col-sm-8\">\r\n                        <h3><a href=\"#/{{menuItem.category.name}}/{{menuItem.title}}\">{{menuItem.title}}</a></h3>\r\n                        <p>{{menuItem.description}}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n\r\n            <div id=\"location-home\"  class=\"col-xs-12 col-sm-6 col-md-4\">\r\n                <h3 class=\"title\">Location and hours of operation</h3>\r\n                <div class=\"row\">\r\n                    <div class=\"thumbnail col-xs-12 col-sm-10\">\r\n                        <div id=\"map\" class=\"map-homepage\"></div>\r\n                    </div>\r\n\r\n                    <div class=\"work-time col-xs-12 col-sm-10\">\r\n                        <span class=\"day title\">Mon-Fri: <span class=\"clock\">9:30 - 18:30</span></span>\r\n                        <span>&nbsp;&nbsp;&nbsp;</span>\r\n                        <span class=\"day title\">Sat-Sun: <span class=\"clock\"></span></span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n\r\n            <div id=\"testimonials\" class=\"col-xs-12 col-sm-6 col-md-4\">\r\n                <h3 class=\"title\">Customer Testimonials</h3>\r\n                <div class=\"testimonial panel panel-default\">\r\n                    <div class=\"panel-body\">\r\n                        <div class=\"thumb pull-left\">\r\n                            <img src=\"/app/images/a-2.jpg\" class=\"img-thumbnail\" alt=\"Kate Alves\">\r\n                        </div>\r\n                        <h3><a href=\"#/\">Kate Alves</a></h3>\r\n                        <p>\r\n                            Pellentesque elementum leo et justo dapibus convalli. In justo nibh, congue nec dapibus\r\n                            ac, placerat eget sem. Nunc consequat felis non elit ultricies in varius massa laoreet.\r\n                            Aenean lectus nisl, ellentesque in fermentum sit amet, convallis a lorem condimentum\r\n                            mollis.\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n\r\n        </div><!-- end .content-items -->\r\n\r\n        <div id=\"btn-browse-menu\" class=\"text-center\">\r\n            <a href=\"#/Menu\" class=\"btn browse-content-btn\">Click Here To Browse The Menu</a>\r\n        </div>\r\n\r\n    </div>\r\n</div><!-- end content-area -->");
$templateCache.put("views/partials/location/location.html","<div class=\"contentMain-header\">\r\n    <div class=\"container\">\r\n        <div>\r\n            <h1 class=\"header-title\">Location</h1>\r\n            <p class=\"header-body\">\r\n                Fusce nunc diam suscipit a iaculis ac tristique ac erat\r\n            </p>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- content -->\r\n\r\n<div id=\"contentMain-content-area\">\r\n    <div id=\"breadcrumbs\">\r\n        <div class=\"container\">\r\n            <ol class=\"breadcrumb pull-left\">\r\n                <li><a href=\"#/\">Home</a></li>\r\n                <li class=\"active\">Location</li>\r\n            </ol>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- content-area -->\r\n\r\n    <div id=\"content-area-container\"  class=\"container\">\r\n        <div class=\"content-items row\" >\r\n            <div>\r\n                <div class=\"col-xs-12 col-sm-4\">\r\n                    <div>\r\n                        <h3 class=\"title\">Address</h3>\r\n                        <p>1051 Nipomo St San Luis Obispo, CA 93401</p>\r\n                    </div>\r\n                    <div>\r\n                        <h3 class=\"title\">Hours of operation</h3>\r\n                        <p>1051 Nipomo St San Luis Obispo, CA 93401</p>\r\n                    </div>\r\n                    <div>\r\n                        <h3 class=\"title\">Contact Info</h3>\r\n                        <p>1051 Nipomo St San Luis Obispo, CA 93401</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div  class=\"thumbnail col-xs-12 col-sm-8\" >\r\n                    <div id=\"map\" class=\"map-locationpage\"></div>\r\n                </div>\r\n            </div>\r\n        </div><!-- end .content-items -->\r\n    </div>\r\n</div><!-- end content-area -->");
$templateCache.put("views/partials/menu/menu.html","<div class=\"contentMain-header\">\r\n    <div class=\"container\">\r\n        <h1 class=\"header-title\">Menu</h1>\r\n        <p class=\"header-body\">\r\n            Fusce nunc diam suscipit a iaculis ac tristique ac erat\r\n        </p>\r\n    </div>\r\n</div>\r\n\r\n<!-- content -->\r\n\r\n<div id=\"contentMain-content-area\">\r\n    <div id=\"breadcrumbs\">\r\n        <div class=\"container\">\r\n            <ol class=\"breadcrumb pull-left\">\r\n                <li><a href=\"#/\">Home</a></li>                \r\n                <li class=\"active\">Menu</li>\r\n            </ol>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- content-area -->\r\n\r\n    <div id=\"content-area-container\" class=\"container\">\r\n        <div class=\"content-items row\">\r\n\r\n            <div class=\"col-xs-12 col-sm-6 col-md-4\" ng-repeat=\"category in vm.menuCategory\">\r\n                <h3 class=\"title\">{{category.name}}</h3>\r\n                <div class=\"recommendation row\" ng-show=\"category.name === menuItem.category.name\" ng-repeat=\"menuItem in vm.menuItems\">\r\n                    <div class=\"thumb col-xs-12 col-sm-4\">\r\n                        <a href=\"#/{{menuItem.category.name}}/{{menuItem.title}}\">\r\n                            <img ng-src=\"{{menuItem.image.url}}\" class=\"img-thumbnail\" alt=\"{{menuItem.title}}\">\r\n                        </a>\r\n                    </div>\r\n                    <div class=\"recommendation-body col-xs-12 col-sm-8\">\r\n                        <h3><a href=\"#/{{menuItem.category.name}}/{{menuItem.title}}\">{{menuItem.title}}</a></h3>\r\n                        <p>{{menuItem.description}}</p>\r\n                    </div>\r\n                </div>\r\n            </div>                  \r\n\r\n        </div><!-- end .content-items -->  \r\n    </div>\r\n</div><!-- end content-area -->");}]);