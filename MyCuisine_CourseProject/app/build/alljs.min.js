$(function () {
    'use strict';

    function config($routeProvider) {

        var PARTIALS_PREFIX = 'app/views/partials/';
        var CONTROLLER_AS_VIEW_MODEL = 'vm';

        $routeProvider
            .when('/', {
                templateUrl: PARTIALS_PREFIX + 'home/home.html',
                controller: 'HomeController',
                controllerAs: CONTROLLER_AS_VIEW_MODEL
            })
            .when('/Home/Location', {
                templateUrl: PARTIALS_PREFIX + 'location/location.html',
                controller: 'LocationController',
                controllerAs: CONTROLLER_AS_VIEW_MODEL
            })
            .when('/Home/Menu', {
                templateUrl: PARTIALS_PREFIX + 'menu/menu.html',
                controller: 'MenuController',
                controllerAs: CONTROLLER_AS_VIEW_MODEL
            })
            .when('/Home/NotFound', {
                templateUrl: PARTIALS_PREFIX + 'errorPage/notFound.html'
            })
            .otherwise({ redirectTo: '/Home/NotFound' });

    }

    function run($http, $cookies, $rootScope, $location) {

        Parse.initialize(
           "XB25RbwIJJMPcISUFMd8yho2qwX3Kpt9useEL0eP",
           "7MDaeNRThiXJi8nm7yWIR32FPorDbj9wUkBFtEev");

        $rootScope.$on('$routeChangeError', function (ev, current, previous, rejection) {
            if (rejection === 'not authorized') {
                $location.path('/');
            }

        });
    }

    angular.module('MyCuisine.services', []);
    angular.module('MyCuisine.directives', []);
    angular.module('MyCuisine.filters', []);

    angular.module('MyCuisine.controllers', ['MyCuisine.services']);
    angular.module('MyCuisine', ['ngRoute', 'ngCookies', 'ui.bootstrap', 'MyCuisine.controllers', 'MyCuisine.directives', 'MyCuisine.filters'])
        .config(['$routeProvider', config])
        .run(['$http', '$cookies', '$rootScope', '$location', run])
        .constant('baseServiceUrl', 'https://api.parse.com/1/');
}());(function () {
    'use strict';

    function menuService(data) {

        var Url = 'classes/Menu?include=category';
        
        function getAll() {            

            return data.get(Url);
        }

        function getRecommended() {

            var urlRecommended = Url + '&where={"recommendation":true}';

            return data.get(urlRecommended);
        }

        return {
            getAll: getAll,
            getRecommended: getRecommended
        };
    }

    angular.module('MyCuisine.services')
        .factory('menuService', ['data', menuService]);
}());(function () {
    'use strict';

    function menuController($location, menuService, menuCategoryService) {
        var vm = this;
                
        vm.menuItems = {};
        vm.menuCategory = {};
        vm.location = $location.path().slice(1).split('/');
        vm.headerTitle = vm.location[1];
        vm.headerBody = 'Fusce nunc diam suscipit a iaculis ac tristique ac erat.';
        vm.currentLocation = vm.location.pop();

        menuService.getAll()
            .then(function (result) {                
                vm.menuItems = result.results;                
            });

        menuCategoryService.getAll()
            .then(function (result) {
                vm.menuCategory = result.results;
            });
    }

    angular.module('MyCuisine.controllers')
        .controller('MenuController', ['$location', 'menuService', 'menuCategoryService', menuController]);
}());(function () {
    'use strict';

    function menuCategoryService(data) {

        var Url = 'classes/Category';

        function getAll() {

            return data.get(Url);
        }


        return {
            getAll: getAll
        };
    }

    angular.module('MyCuisine.services')
        .factory('menuCategoryService', ['data', menuCategoryService]);
}());(function () {
    'use strict';

    function locationService(data) {

        var Url = 'classes/Info';

        function getAll() {

            return data.get(Url);
        }
        
        function getMap() {
            var map,
            center,
            marker,
            mapOptions,
            markerOptions;

            center = new google.maps.LatLng(42.650698, 23.379031);

            mapOptions = {
                zoom: 15,
                center: center,

            };

            map = new google.maps.Map(document.getElementById('map'), mapOptions);

            markerOptions = {
                map: map,
                position: center
            };

            marker = new google.maps.Marker(markerOptions);

            window.setTimeout(function () {
                google.maps.event.trigger(map, 'resize');
            }, 100);
        }

        return {
            getAll: getAll,
            getMap: getMap
        };
    }

    angular.module('MyCuisine.services')
        .factory('locationService', ['data', locationService]);
}());(function () {
    'use strict';

    function locationController($location, locationService) {
        var vm = this;

        vm.info = {};
        vm.location = $location.path().slice(1).split('/');
        vm.headerTitle = vm.location[1];
        vm.headerBody = 'Fusce nunc diam suscipit a iaculis ac tristique ac erat.';
        vm.currentLocation = vm.location.pop();
        
        locationService.getAll()
            .then(function (result) {
                vm.info = result.results[0];
            });

        locationService.getMap();
    }

    angular.module('MyCuisine.controllers')
        .controller('LocationController', ['$location', 'locationService', locationController]);
}());(function () {
    'use strict';

    function testimonialsService(data) {

        var URL = 'classes/Testimonials?include=customer';

        function getAll() {
            return data.get(URL);
        }

        return {
            getAll: getAll
        };
    }

    angular.module('MyCuisine.services')
        .factory('testimonialsService', ['data', testimonialsService]);
}());(function () {
    'use strict';
       
    function homeController(carouselService, menuService, locationService, testimonialsService) {
        var vm = this;
                
        vm.carouselItems = {};
        vm.menuItems = {};
        vm.info = {};
        vm.testimonial = {};

        carouselService.getAll()
            .then(function (result) {
                vm.carouselItems = result.results;
            });        

        menuService.getRecommended()
            .then(function (result) {
                vm.menuItems = result.results;
            });

        testimonialsService.getAll()
            .then(function (result) {
                vm.testimonial = result.results[0];
            });
                
        locationService.getAll()
            .then(function (result) {
                vm.info = result.results[0];
            });

        locationService.getMap();
    }

    angular.module('MyCuisine.controllers')
        .controller('HomeController', [
            'carouselService',
            'menuService',
            'locationService',
            'testimonialsService',
            homeController]);
}());(function () {
    'use strict';

    function carouselService(data) {

        var URL = 'classes/HeaderItem';

        function getAll() {
            return data.get(URL);
        }
                
        return {
            getAll: getAll
        };
    }

    angular.module('MyCuisine.services')
        .factory('carouselService', ['data', carouselService]);
}());/// <reference path="D:\GitHub\SliceAndDiceCourseProject\MyCuisine_CourseProject\bower_components/jquery/dist/jquery.js" />

(function () {
    'use strict';

    function navDirective() {

        function clickedLink($scope, $element, $attrs) {

            $element.on('click', 'a', function () {
                var name,
                    location = $(this).attr('href');

                if(location[0] !== '#'){
                    return;
                }

                location = location.slice(2).split('/');
                
                if (location.length > 1) {
                    name = location[1];
                } else {
                    name = 'Home';
                }
                                
                $('#myCuisine-navbar-collapse li[name=' + name + ']').parent().children('.active').removeClass('active');
                $('#myCuisine-footer nav li[name=' + name + ']').parent().children('.active').removeClass('active');

                $('#myCuisine-navbar-collapse li[name=' + name + ']').addClass('active');
                $('#myCuisine-footer nav li[name=' + name + ']').addClass('active');                                              

                if ($('#myCuisine-navbar-collapse').attr('aria-expanded') === 'true') {
                    $('#myCuisine-navbar-collapse').collapse('toggle');
                }
            });
        }

        return {
            restrict: 'A',
            link: clickedLink
        };
    }

    angular.module('MyCuisine.directives')
        .directive('navDirective', [navDirective]);
}());(function () {
    'use strict';
        
    function mainController() {
        var vm = this;

//         waitForLogin();
// 
//         vm.logout = function () {
//             vm.globallySetCurrentUser = undefined;
//             auth.logout();
//             waitForLogin();
//             $location.path('/');
//         };
// 
//         function waitForLogin() {
//             identity.getUser()
//                 .then(function (user) {
//                     vm.globallySetCurrentUser = user;
//                 });
//         }
    }

    angular.module('MyCuisine.controllers')
        .controller('MainController', [mainController]);
}());(function () {
    'use strict';    

    function dataService($http, $q, baseUrl) {

        function get(url, params) {
            var defered = $q.defer();

            $http
                .get(baseUrl + url, { 
                    params: params,
                    headers: {                        
                        'X-Parse-Application-Id': 'XB25RbwIJJMPcISUFMd8yho2qwX3Kpt9useEL0eP',
                        'X-Parse-REST-API-Key': 'q4rQJ2UDIPwxbXw0QWPdKz7VBj1RFz0pGiedBgib'
                    }
                })
                .then(function (response) {                    
                    defered.resolve(response.data);
                }, function (err) {
                    
                    defered.reject(err);
                });

            return defered.promise;
        }

        function post(url, data) {
            var defered = $q.defer();

            $http
                .post(baseUrl + url, data)
                .then(function (response) {
                    defered.resolve(response.data);
                }, function (err) {
                    
                    defered.reject(err);
                });

            return defered.promise;
        }

        function put(url, data) {
            var defered = $q.defer();

            $http
                .put(baseUrl + url, data)
                .then(function (response) {
                    defered.resolve(response.data);
                }, function (err) {
                    defered.reject(err);
                });

            return defered.promise;
        }

        return {
            get: get,
            post: post,
            put: put
        };
    }

    angular.module('MyCuisine.services')
        .factory('data', ['$http', '$q', 'baseServiceUrl', dataService]);
}());angular.module("templates").run(["$templateCache", function($templateCache) {$templateCache.put("views/partials/errorPage/notFound.html","<div class=\"contentMain-header\">\r\n    <div class=\"container\">\r\n        <div>\r\n            <h1 class=\"header-title\">Page not found</h1>\r\n            <p class=\"header-body\">\r\n                ...\r\n            </p>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- content -->\r\n\r\n<div id=\"contentMain-content-area\">\r\n    <div id=\"breadcrumbs\">\r\n        <div class=\"container\">\r\n            <ol class=\"breadcrumb pull-left\">\r\n                <li><a href=\"#/\">Home</a></li>\r\n                <li class=\"active\">Not Found</li>\r\n            </ol>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- content-area -->\r\n\r\n    <div id=\"content-area-container\" ng-cloak class=\"container\">\r\n        <div class=\"content-items row\">\r\n            <div class=\"error-page bg-danger text-info text-center col-xs-12\">\r\n                <p>Page can not be found.</p>\r\n                <p>Use the menu above or below.</p>                \r\n            </div>\r\n        </div><!-- end .content-items -->\r\n    </div>\r\n</div><!-- end content-area -->");
$templateCache.put("views/partials/home/home.html","<div class=\"contentMain-header\" >\r\n    <div id=\"myCuisineCarousel\" ng-cloak class=\"carousel slide\" data-ride=\"carousel\">\r\n        <!-- Indicators -->\r\n        <ol id=\"carousel-indicators\" class=\"carousel-indicators\">\r\n            <li data-target=\"#myCuisineCarousel\" ng-repeat=\"carouselItem in vm.carouselItems\" ng-class=\"{active: (carouselItem.position === 0)}\" data-slide-to=\"{{carouselItem.position}}\"></li>\r\n        </ol>\r\n\r\n        <!-- Wrapper for slides -->\r\n        <div class=\"carousel-inner\">\r\n            <div ng-class=\"{item: true, active : (carouselItem.position === 0)}\" ng-repeat=\"carouselItem in vm.carouselItems\">\r\n                <img ng-src=\"{{carouselItem.image.url}}\" alt=\"{{carouselItem.title}}\">\r\n                <div class=\"container\">\r\n                    <div class=\"carousel-caption\">\r\n                        <h1 class=\"header-title\">{{carouselItem.title}}</h1>\r\n                        <p class=\"header-body\">\r\n                            {{carouselItem.description}}\r\n                        </p>\r\n                        <a href=\"#/\" class=\"btn browse-content-btn\">Button’s Text Goes Right Here</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Controls -->\r\n        <a class=\"left carousel-control\" href=\"#myCuisineCarousel\" role=\"button\" data-slide=\"prev\">\r\n            <span class=\"glyphicon glyphicon-chevron-left\"></span>\r\n        </a>\r\n        <a class=\"right carousel-control\" href=\"#myCuisineCarousel\" role=\"button\" data-slide=\"next\">\r\n            <span class=\"glyphicon glyphicon-chevron-right\"></span>\r\n        </a>\r\n    </div><!-- end carousel -->\r\n</div>\r\n<!-- ==================================================== -->\r\n\r\n<div id=\"contentMain-content-area\" ng-cloak>\r\n    <div id=\"slogan\">\r\n        <div class=\"container\">\r\n            <h2 class=\"slogan-header\">“Your awesome company slogan goes here, we have the best food around”</h2>\r\n            <h5 class=\"slogan-body\">Unc elementum lacus in gravida pellentesque urna dolor eleifend felis eleifend</h5>\r\n            <div id=\"stars\">\r\n                <span class=\"glyphicon glyphicon-star-empty\"></span>\r\n                <span class=\"glyphicon glyphicon-star-empty\"></span>\r\n                <span class=\"glyphicon glyphicon-star-empty\"></span>\r\n                <span class=\"glyphicon glyphicon-star-empty\"></span>\r\n                <span class=\"glyphicon glyphicon-star-empty\"></span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- sssssss -->\r\n\r\n    <div id=\"content-area-container\" class=\"container\">\r\n        <div class=\"content-items row\">\r\n\r\n            <div id=\"recommendations\" ng-cloak class=\"col-xs-12 col-sm-6 col-md-4\">\r\n                <h3 class=\"title\">Chef\'s Recommendations</h3>\r\n                <div class=\"recommendation row\" ng-show=\"menuItem.recommendation\" ng-repeat=\"menuItem in vm.menuItems\">\r\n                    <div class=\"thumb col-xs-12 col-sm-4\">\r\n                        <a href=\"#/{{menuItem.category.name}}/{{menuItem.title}}\">\r\n                            <img ng-src=\"{{menuItem.image.url}}\" class=\"img-thumbnail\" alt=\"{{menuItem.title}}\">\r\n                        </a>\r\n                    </div>\r\n                    <div class=\"recommendation-body col-xs-12 col-sm-8\">\r\n                        <h3><a href=\"#/{{menuItem.category.name}}/{{menuItem.title}}\">{{menuItem.title}}</a></h3>\r\n                        <p>{{menuItem.description}}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n\r\n            <div id=\"location-home\" ng-cloak class=\"col-xs-12 col-sm-6 col-md-4\">\r\n                <h3 class=\"title\">Location and hours of operation</h3>\r\n                <div class=\"row\">\r\n                    <div class=\"thumbnail col-xs-12 col-sm-10\">\r\n                        <div id=\"map\" class=\"map-homepage\"></div>\r\n                    </div>\r\n\r\n                    <div class=\"work-time col-xs-12 col-sm-10\">\r\n                        <span class=\"day title\">Mon-Fri: <span class=\"clock\">{{vm.info.mondayFriday}}</span></span>\r\n                        <span>&nbsp;&nbsp;&nbsp;</span>\r\n                        <span class=\"day title\">Sat-Sun: <span class=\"clock\">{{vm.info.saturdaySunday}}</span></span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n\r\n            <div id=\"testimonials\" ng-cloak class=\"col-xs-12 col-sm-6 col-md-4\">\r\n                <h3 class=\"title\">Customer Testimonials</h3>\r\n                <div class=\"testimonial panel panel-default\">\r\n                    <div class=\"panel-body\">\r\n                        <div class=\"thumb pull-left\">\r\n                            <img ng-src=\"{{vm.testimonial.customer.avatar.url}}\" class=\"img-thumbnail\" alt=\"{{vm.testimonial.customer.firstName}} {{vm.testimonial.customer.lastName}}\">\r\n                        </div>\r\n                        <h3><a href=\"#/\">{{vm.testimonial.customer.firstName}}&nbsp;{{vm.testimonial.customer.lastName}}</a></h3>\r\n                        <p>{{vm.testimonial.content}}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n\r\n        </div><!-- end .content-items -->\r\n\r\n        <div id=\"btn-browse-menu\" class=\"text-center\">\r\n            <a href=\"#/Home/Menu\" class=\"btn browse-content-btn\">Click Here To Browse The Menu</a>\r\n        </div>\r\n\r\n    </div>\r\n</div><!-- end content-area -->");
$templateCache.put("views/partials/location/location.html","<div class=\"contentMain-header\">\r\n    <div class=\"container\">\r\n        <div  ng-cloak>\r\n            <h1 class=\"header-title\">{{vm.headerTitle}}</h1>\r\n            <p class=\"header-body\">\r\n                {{vm.headerBody}}\r\n            </p>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- content -->\r\n\r\n<div id=\"contentMain-content-area\">\r\n    <div id=\"breadcrumbs\">\r\n        <div class=\"container\">\r\n            <ol class=\"breadcrumb pull-left\">\r\n                <li ng-repeat=\"item in vm.location\"><a href=\"#/\">{{item}}</a></li>\r\n                <li class=\"active\">{{vm.currentLocation}}</li>\r\n            </ol>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- content-area -->\r\n\r\n    <div id=\"content-area-container\" ng-cloak class=\"container\">\r\n        <div class=\"content-items row\" >\r\n            <div id=\"location-page-content\" ng-cloak>\r\n                <div class=\"col-xs-12 col-sm-4\">\r\n                    <div>\r\n                        <h3 class=\"title\">Address</h3>\r\n                        <p>{{vm.info.address}}</p>\r\n                    </div>\r\n                    <div>\r\n                        <h3 class=\"title\">Hours of operation</h3>\r\n                        <p>Monday-Friday: <span>{{vm.info.mondayFriday}}</span></p>\r\n                        <p>Saturday-Sunday: <span>{{vm.info.saturdaySunday}}</span></p>\r\n                    </div>\r\n                    <div>\r\n                        <h3 class=\"title\">Contact Info</h3>\r\n                        <p>Email Address: <span>{{vm.info.email}}</span></p>\r\n                        <p>Telephone: <span>{{vm.info.telephone}}</span></p>\r\n                        <p>Fax: <span>{{vm.info.fax}}</span></p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div ng-cloak class=\"thumbnail col-xs-12 col-sm-8\" >\r\n                    <div id=\"map\" class=\"map-locationpage\"></div>\r\n                </div>\r\n            </div>\r\n        </div><!-- end .content-items -->\r\n    </div>\r\n</div><!-- end content-area -->");
$templateCache.put("views/partials/menu/menu.html","<div class=\"contentMain-header\">\r\n    <div class=\"container\">\r\n        <div ng-cloak>\r\n            <h1 class=\"header-title\">{{vm.headerTitle}}</h1>\r\n            <p class=\"header-body\">\r\n                {{vm.headerBody}}\r\n            </p>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- content -->\r\n\r\n<div id=\"contentMain-content-area\">\r\n    <div id=\"breadcrumbs\">\r\n        <div class=\"container\">\r\n            <ol class=\"breadcrumb pull-left\">\r\n                <li ng-repeat=\"item in vm.location\"><a href=\"#/\">{{item}}</a></li>\r\n                <li class=\"active\">{{vm.currentLocation}}</li>\r\n            </ol>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- content-area -->\r\n\r\n    <div id=\"content-area-container\" ng-cloak class=\"container\">\r\n        <div class=\"content-items row\">\r\n\r\n            <div ng-cloak class=\"col-xs-12 col-sm-6 col-md-4\" ng-repeat=\"category in vm.menuCategory\">\r\n                <h3 class=\"title\">{{category.name}}</h3>\r\n                <div class=\"recommendation row\" ng-show=\"category.name === menuItem.category.name\" ng-repeat=\"menuItem in vm.menuItems\">\r\n                    <div class=\"thumb col-xs-12 col-sm-4\">\r\n                        <a href=\"#/{{menuItem.category.name}}/{{menuItem.title}}\">\r\n                            <img ng-src=\"{{menuItem.image.url}}\" class=\"img-thumbnail\" alt=\"{{menuItem.title}}\">\r\n                        </a>\r\n                    </div>\r\n                    <div class=\"recommendation-body col-xs-12 col-sm-8\">\r\n                        <h3><a href=\"#/{{menuItem.category.name}}/{{menuItem.title}}\">{{menuItem.title}}</a></h3>\r\n                        <p>{{menuItem.description}}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        </div><!-- end .content-items -->\r\n    </div>\r\n</div><!-- end content-area -->");}]);